## HTTP Bearer authentication
Bearer authentication (also called token authentication) is an HTTP authentication scheme that involves security tokens called bearer tokens. The name "Bearer authentication" can be understood as "give access to the bearer of this token." The bearer token is a cryptic string, usually generated by the server in response to a login request. The client must send this token in the Authorization header when making requests to protected resources:

```http request
Authorization: Bearer <token>
```

### Enterprise interface HTTP Bearer authentication

As described below, for authentication through HTTP Bearer, you will need a bearer token.

In REST API, you can get this token as a response from a successful call of [the user login action method](#operation/postUserLogin).
<p class="warning">⚠️ Bearer token validity has a default value of 7 hours. Every project can customize the validity of the bearer token.</p>

For a successful login, you will need the ID of the external application and user credentials.
If you already have all information, you can continue to [Authentication process](#authentication-process). If you miss any parameters, please check [User credential](#user-credentials) and [External applications](#external-applications) sections.


#### User credentials

If you miss user credentials, you can create or get them in section Users of CDP administration.
Complete user setup is located in:
```text
System configuration > User authorization > Users
```

<img src="img/user_add.png">

If you want to use a user from CDP CareCloud, you need to set the 'User Group' option in the user form to value `webservice`.

#### External applications
The external application represents an application that wants to/ already communicate with CPD CareCloud REST API. Every system needs to be identified, and that's why we need to know the external application ID.
It could be one of the following examples:
- a mobile app for the customer  purchase overview
- e-shop that uses customers data
- production system that wants to synchronize customer purchases

If you need an external application ID, you can get it in CDP administration in the section External applications
```text
System configuration > External applications
```

<img src="img/external_app_overview.png"> <br/>


Or you can also add a new external application to the system by the following form in the same section:


<img src="img/external_app_add.png"> <br/>


For CDP REST API use, please get an Encoded ID.

#### Authentication process
If you have all mandatory parameters, you can continue with the user login API call.

User login request :

```http request
POST https://<projectURL>/webservice/rest-api/enterprise-interface/v1.0/users/actions/login
Content-Type: application/json
Accept-Language: cs, en-gb;q=0.8

{
  "user_external_application_id": "4d9495b4e723e7a",
  "login": "example@crmcarecloud.com",
  "password": "password_example"
}
```

Bearer token in response to the method:

```json
{
  "data":{
    "bearer_token": "09359095c5da43c7ae11e710eabce49"
  }
}
```


After you successfully get your bearer token, please add it to every REST API calls in the Enterprise interface with the following syntax:

```http request
GET https://<projectURL>/webservice/rest-api/enterprise-interface/v1.0/customers
Content-Type: application/json
Accept-Language: cs, en-gb;q=0.8
Authorization: Bearer 09359095c5da43c7ae11e710eabce49
```

Response:

```http request
HTTP/1.1 200 OK
Date: Mon, 22 Jul 2019 11:54:39 GMT
Content-Type: application/json; charset=utf-8
```

```json
{
    "data": {
        "customers": [
            {
                "customer_id": "8ea6abece4cd0a4ded0a29f093",
                "personal_information": {
                    "gender": 1,
                    "first_name": "John",
                    "last_name": "Smith",
                    "birthdate": "985-02-12",
                    "email": "happy_customer@crmcarecloud.com",
                    "phone": "420523828931",
                    "language_id": "en",
                    "store_id": "8bed991c68a4",
                    "address": {
                        "address1": "Old Town Square",
                        "address2": "34",
                        "address3": "",
                        "address4": "",
                        "address5": "",
                        "address6": "",
                        "address7": "",
                        "zip": "11000",
                        "city": "Prague 1",
                        "country_code": "cz"
                    },
                    "agreement": {
                        "agreement_gtc": 1,
                        "agreement_profiling": 1,
                        "agreement_marketing_communication": 1,
                        "custom_agreements": [
                            {
                                "agreement_id": "89ce2a1b9b01f5c939fb1e20cd",
                                "agreement_value": 2
                            }
                        ]
                    }
                },
                "last_change": "2019-06-23 11:47:22",
                "state": 1
            }
        ],
        "total_items": 1
    }
}
```